var FASHIONADE=function($w){var $=function(e){return document.querySelector(e)},$$=function(e){return document.querySelectorAll(e)},get=function(url,cb){var xmlhttp;xmlhttp=new XMLHttpRequest,xmlhttp.onreadystatechange=function(){4==xmlhttp.readyState&&200==xmlhttp.status&&cb(eval(xmlhttp.responseText))},xmlhttp.open("GET",url,!0),xmlhttp.send()},post=function(e,n){var a;(a=new XMLHttpRequest).onreadystatechange=function(){4==a.readyState&&200==a.status&&console.log("succeed",request.responseText)},a.open("POST",e,!0),a.setRequestHeader("Content-Type","application/json"),a.send(JSON.stringify(n))},strTitle=function(e,n){for(var a="",t=0,r=e.length;t<r;++t)a+='<li class="'+(0===t?"on":"")+'" onClick="'+function(e,n){return"overlay"===n?"FASHIONADE.RECOMMEND_LAYER_CURRENT("+(e+1)+")":"FASHIONADE.RECOMMEND_CURRENT("+(e+1)+")"}(t,n)+'">'+e[t].name+"</li>";return'<ul class="fashionade--recommendTitleList">'+a+"</ul>"},strContent=function(e,n){for(var a="",t=0,r=e.length;t<r;++t)a+="<li>"+("overlay"===n?strmainImage(e[t].images):"")+strItems(e[t].items)+"</li>";return'<ul class="fashionade--recommendContentList">'+a+"</ul>"},strmainImage=function(e){return'<div class="fashionade--mainImageWrap">                 <div class="fashionade--mainImage"><img src="'+e[0]+'" width="280" height="424" alt="" /></div>                 </div>'},strItems=function(e){for(var n="",a=0;a<3;++a)n+='<li class="fashionade--item">                 <div class="fashionade--thumb" style="background-image:url(\''+e[a].imageUrl+'\')"><a href="'+e[a].detailUrl+'" target="_blank" onclick="FASHIONADE.LOGS(\'click\')">'+e[a].name+'</a></div>         <div class="fashionade--content">           <dl>         <dt class="fashionade--brand"><a href="'+e[a].detailUrl+'" target="_blank" onclick="FASHIONADE.LOGS(\'click\')">'+e[a].brand+'</a></dt>         <dd class="fashionade--name"><a href="'+e[a].detailUrl+'" target="_blank" onclick="FASHIONADE.LOGS(\'click\')">'+e[a].name+"</a></dd>           </dl>         </div>       </li>";return'<div class="fashionade--itemList"><ul>'+n+"</ul></div>"},RECOMMEND={INDEX:1,LAYER_INDEX:1,DATA:null,direct:function(e){RECOMMEND.show(RECOMMEND.INDEX+=e)},current:function(e){RECOMMEND.show(RECOMMEND.INDEX=e)},show:function(e){var n=$$(".fashionade--renderWrap .fashionade--recommendTitleList > li"),a=$$(".fashionade--renderWrap .fashionade--recommendContentList > li");e>a.length&&(RECOMMEND.INDEX=1),e<1&&(RECOMMEND.INDEX=a.length);for(var t=0,r=a.length;t<r;++t)a[t].style.display="none",n[t].className="";a[RECOMMEND.INDEX-1].style.display="block",n[RECOMMEND.INDEX-1].className="on"},layer_direct:function(e){RECOMMEND.layer_show(RECOMMEND.LAYER_INDEX+=e)},layer_current:function(e){RECOMMEND.layer_show(RECOMMEND.LAYER_INDEX=e)},layer_show:function(e){var n=$$(".fashionade--layerWrap .fashionade--recommendTitleList > li"),a=$$(".fashionade--layerWrap .fashionade--recommendContentList > li");e>a.length&&(RECOMMEND.LAYER_INDEX=1),e<1&&(RECOMMEND.LAYER_INDEX=a.length);for(var t=0,r=a.length;t<r;++t)a[t].style.display="none",n[t].className="";a[RECOMMEND.LAYER_INDEX-1].style.display="block",n[RECOMMEND.LAYER_INDEX-1].className="on"},layer_remove:function(){$('[data-fashionade-render-recommend-type="overlay"]').innerHTML=""},showMainImage:function(e,n){for(var a=e.parentNode.getElementsByTagName("li"),t=new Image,r=0,o=a.length;r<o;++r)a[r].className="";e.className="on",t.onload=function(){e.parentNode.parentNode.childNodes[3].childNodes[0].src=n},t.src=n}},getUrlParams=function(){var e={};return window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(n,a,t){e[a]=t})),e},getMadUuid=function(){if(localStorage.getItem("madUuid"))return localStorage.getItem("madUuid");var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)}));return localStorage.setItem("madUuid",e),e},config={apiUrl:"https://www.fashionade.ai/api/v1/recommend-products",apiParams:{productId:getUrlParams().productId||location.pathname.split("/")[3]||"",madUuid:getMadUuid(),userId:"",appKey:"cahiers_test_9sdf9d8f982394hds9fhs9h923a"}},genLogData=function(e){return{type:e,appKey:"cahiers_test_9sdf9d8f982394hds9fhs9h923a",uuid:getMadUuid(),userId:"",userAgent:navigator.userAgent,lang:navigator.language,page:location.href,referrer:document.referrer,ext:{},deviceTime:new Date}},postLogs=function(e){post("https://admin.fashionade.ai/dev_logs",genLogData(e))},utils={jsonToParams:function(e){var n="?";for(var a in e)n+=encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&";return n.substring(0,n.length-1)}},render=function(){get(config.apiUrl+utils.jsonToParams(config.apiParams),(function(e){FASHIONADE.LOGS("init"),e.length>0&&($('[data-fashionade-render-recommend-type="overlay"]')&&$('[data-fashionade-open-layer="recommend"]')&&($('[data-fashionade-open-layer="recommend"]').onclick=function(){$('[data-fashionade-render-recommend-type="overlay"]').innerHTML='<div class="fashionade--layerWrap"><div class="fashionade--layerInnerWrap">'+strTitle(e,"overlay")+strContent(e,"overlay")+(e.length>1?'<button class="fashionade--btn fashionade--prev" onClick="FASHIONADE.RECOMMEND_LAYER_DIRECT(-1)">이전 추천보기</button>                         <button class="fashionade--btn fashionade--next" onClick="FASHIONADE.RECOMMEND_LAYER_DIRECT(1)">다음 추천보기</button>':"")+'<button class="fashionade--btn fashionade--close" onClick="FASHIONADE.RECOMMEND_LAYER_REMOVE()">닫기</button></div></div>                             <div class="fashionade--dimmed" onClick="FASHIONADE.RECOMMEND_LAYER_REMOVE()"></div>',FASHIONADE.LOGS("open")}),$('[data-fashionade-render-recommend-type="render"]')&&($('[data-fashionade-render-recommend-type="render"]').innerHTML='<div class="fashionade--renderWrap">'+strTitle(e)+strContent(e)+(e.length>1?'<button class="fashionade--btn fashionade--prev" onClick="FASHIONADE.RECOMMEND_DIRECT(-1)">이전 추천보기</button>                     <button class="fashionade--btn fashionade--next" onClick="FASHIONADE.RECOMMEND_DIRECT(1)">다음 추천보기</button>':"")+"</div>",FASHIONADE.LOGS("render")))}))};return document.addEventListener("DOMContentLoaded",render),{RECOMMEND_DATA:RECOMMEND.DATA,RECOMMEND_DIRECT:RECOMMEND.direct,RECOMMEND_CURRENT:RECOMMEND.current,RECOMMEND_LAYER_DIRECT:RECOMMEND.layer_direct,RECOMMEND_LAYER_CURRENT:RECOMMEND.layer_current,RECOMMEND_LAYER_REMOVE:RECOMMEND.layer_remove,RECOMMEND_LAYER_MAINIMAGE:RECOMMEND.layer_showMainImage,LOGS:function(e){postLogs(e)},RENDER:render}}(window);
