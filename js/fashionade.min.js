var FASHIONADE=function($w){var $=function(e){return document.querySelector(e)},$$=function(e){return document.querySelectorAll(e)},get=function(url,cb){var xmlhttp;xmlhttp=new XMLHttpRequest,xmlhttp.onreadystatechange=function(){4==xmlhttp.readyState&&200==xmlhttp.status&&cb(eval(xmlhttp.responseText))},xmlhttp.open("GET",url,!0),xmlhttp.send()},post=function(e,a){var n;(n=new XMLHttpRequest).onreadystatechange=function(){4==n.readyState&&200==n.status&&console.log("succeed",request.responseText)},n.open("POST",e,!0),n.setRequestHeader("Content-Type","application/json"),n.send(JSON.stringify(a))},strTitle=function(e,a){for(var n="",t=0,r=e.length;t<r;++t)n+='<li class="'+(0===t?"on":"")+'" onClick="'+function(e,a){return"overlay"===a?"FASHIONADE.RECOMMEND_LAYER_CURRENT("+(e+1)+")":"FASHIONADE.RECOMMEND_CURRENT("+(e+1)+")"}(t,a)+'">'+e[t].name+"</li>";return'<ul class="fashionade--recommendTitleList">'+n+"</ul>"},strContent=function(e,a){for(var n="",t=0,r=e.length;t<r;++t)n+="<li>"+("overlay"===a?strmainImage(e[t].images):"")+strItems(e[t].items)+"</li>";return'<ul class="fashionade--recommendContentList">'+n+"</ul>"},strmainImage=function(e){return'<div class="fashionade--mainImageWrap">                 <div class="fashionade--mainImage"><img src="'+e[0]+'" width="280" height="424" alt="" /></div>                 </div>'},strItems=function(e){for(var a="",n=0;n<3;++n)a+='<li class="fashionade--item">                 <div class="fashionade--thumb" style="background-image:url(\''+e[n].imageUrl+'\')"><a href="'+e[n].detailUrl+'" target="_blank" onclick="FASHIONADE.LOGS(\'click\')">'+e[n].name+'</a></div>         <div class="fashionade--content">           <dl>         <dt class="fashionade--brand"><a href="'+e[n].detailUrl+'" target="_blank" onclick="FASHIONADE.LOGS(\'click\')">'+e[n].brand+'</a></dt>         <dd class="fashionade--name"><a href="'+e[n].detailUrl+'" target="_blank" onclick="FASHIONADE.LOGS(\'click\')">'+e[n].name+"</a></dd>           </dl>         </div>       </li>";return'<div class="fashionade--itemList"><ul>'+a+"</ul></div>"},RECOMMEND={INDEX:1,LAYER_INDEX:1,DATA:null,direct:function(e){RECOMMEND.show(RECOMMEND.INDEX+=e)},current:function(e){RECOMMEND.show(RECOMMEND.INDEX=e)},show:function(e){var a=$$(".fashionade--renderWrap .fashionade--recommendTitleList > li"),n=$$(".fashionade--renderWrap .fashionade--recommendContentList > li");e>n.length&&(RECOMMEND.INDEX=1),e<1&&(RECOMMEND.INDEX=n.length);for(var t=0,r=n.length;t<r;++t)n[t].style.display="none",a[t].className="";n[RECOMMEND.INDEX-1].style.display="block",a[RECOMMEND.INDEX-1].className="on"},layer_direct:function(e){RECOMMEND.layer_show(RECOMMEND.LAYER_INDEX+=e)},layer_current:function(e){RECOMMEND.layer_show(RECOMMEND.LAYER_INDEX=e)},layer_show:function(e){var a=$$(".fashionade--layerWrap .fashionade--recommendTitleList > li"),n=$$(".fashionade--layerWrap .fashionade--recommendContentList > li");e>n.length&&(RECOMMEND.LAYER_INDEX=1),e<1&&(RECOMMEND.LAYER_INDEX=n.length);for(var t=0,r=n.length;t<r;++t)n[t].style.display="none",a[t].className="";n[RECOMMEND.LAYER_INDEX-1].style.display="block",a[RECOMMEND.LAYER_INDEX-1].className="on"},layer_remove:function(){$('[data-fashionade-render-recommend-type="overlay"]').innerHTML=""},showMainImage:function(e,a){for(var n=e.parentNode.getElementsByTagName("li"),t=new Image,r=0,o=n.length;r<o;++r)n[r].className="";e.className="on",t.onload=function(){e.parentNode.parentNode.childNodes[3].childNodes[0].src=a},t.src=a}},getUrlParams=function(){var e={};return window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(a,n,t){e[n]=t})),e},getMadUuid=function(){if(localStorage.getItem("madUuid"))return localStorage.getItem("madUuid");var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var a=16*Math.random()|0;return("x"==e?a:3&a|8).toString(16)}));return localStorage.setItem("madUuid",e),e},config={apiUrl:"https://www.fashionade.ai/api/v1/recommend-products",apiParams:{productId:getUrlParams().productId||location.pathname.split("/")[3]||"",madUuid:getMadUuid(),userId:"",appKey:"cahiers_test_9sdf9d8f982394hds9fhs9h923a"}},genLogData=function(e){return{type:e,appKey:"cahiers_test_9sdf9d8f982394hds9fhs9h923a",uuid:getMadUuid(),userId:"",userAgent:navigator.userAgent,lang:navigator.language,page:location.href,referrer:document.referrer,ext:{},deviceTime:new Date}},postLogs=function(e){post("https://admin.fashionade.ai/dev_logs",genLogData(e))},utils={jsonToParams:function(e){var a="?";for(var n in e)a+=encodeURIComponent(n)+"="+encodeURIComponent(e[n])+"&";return a.substring(0,a.length-1)}},render=function(){get(config.apiUrl+utils.jsonToParams(config.apiParams),(function(e){FASHIONADE.LOGS("init"),e.length>0&&($('[data-fashionade-render-recommend-type="overlay"]')&&$('[data-fashionade-open-layer="recommend"]')&&($('[data-fashionade-open-layer="recommend"]').onclick=function(){$('[data-fashionade-render-recommend-type="overlay"]').innerHTML='<div class="fashionade--layerWrap"><div class="fashionade--layerInnerWrap">'+strTitle(e,"overlay")+strContent(e,"overlay")+(e.length>1?'<button class="fashionade--btn fashionade--prev" onClick="FASHIONADE.RECOMMEND_LAYER_DIRECT(-1)">이전 추천보기</button>                         <button class="fashionade--btn fashionade--next" onClick="FASHIONADE.RECOMMEND_LAYER_DIRECT(1)">다음 추천보기</button>':"")+'<button class="fashionade--btn fashionade--close" onClick="FASHIONADE.RECOMMEND_LAYER_REMOVE()">닫기</button></div></div>                             <div class="fashionade--dimmed" onClick="FASHIONADE.RECOMMEND_LAYER_REMOVE()"></div>',FASHIONADE.LOGS("open")}),$('[data-fashionade-render-recommend-type="render"]')&&($('[data-fashionade-render-recommend-type="render"]').innerHTML='<div class="fashionade--renderWrap">'+strTitle(e)+strContent(e)+(e.length>1?'<button class="fashionade--btn fashionade--prev" onClick="FASHIONADE.RECOMMEND_DIRECT(-1)">이전 추천보기</button>                     <button class="fashionade--btn fashionade--next" onClick="FASHIONADE.RECOMMEND_DIRECT(1)">다음 추천보기</button>':"")+"</div>",FASHIONADE.LOGS("render")),$(".fashionade--btn-overlay")&&($(".fashionade--btn-overlay").style.display="block"))}))};return document.addEventListener("DOMContentLoaded",render),{RECOMMEND_DATA:RECOMMEND.DATA,RECOMMEND_DIRECT:RECOMMEND.direct,RECOMMEND_CURRENT:RECOMMEND.current,RECOMMEND_LAYER_DIRECT:RECOMMEND.layer_direct,RECOMMEND_LAYER_CURRENT:RECOMMEND.layer_current,RECOMMEND_LAYER_REMOVE:RECOMMEND.layer_remove,RECOMMEND_LAYER_MAINIMAGE:RECOMMEND.layer_showMainImage,LOGS:function(e){postLogs(e)},RENDER:render}}(window);
